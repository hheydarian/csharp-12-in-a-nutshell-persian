# ูุตู ฺูุงุฑุฏูู: ููโุฒูุงู ู ูุงููโุฒูุงู

ุจุดุชุฑ ุจุฑูุงููโูุง ูุงุฒ ุฏุงุฑูุฏ ุจุง ุจุด ุงุฒ ฺฉ ุฑูุฏุงุฏ ฺฉู ุจูโุทูุฑ ููโุฒูุงู ุฑุฎ ูโุฏูุฏ ุณุฑูฺฉุงุฑ ุฏุงุดุชู ุจุงุดูุฏ (ููโุฒูุงู ุง **Concurrency**).
ุฏุฑ ุงู ูุตูุ ูุง ุจุง ูพุดโูุงุฒูุง ุถุฑูุฑ ุดุฑูุน ูโฺฉููุ ุนู ูุจุงู **Threading** (ุงุฌุงุฏ ู ูุฏุฑุช ุฑุดุชูโูุง) ู **Tasks** (ูุธุงู)ุ ู ุณูพุณ ุงุตูู **Asynchrony** (ูุงููโุฒูุงู) ู ุชูุงุจุน ูุงููโุฒูุงู ุฏุฑ #C ุฑุง ุจุง ุฌุฒุฆุงุช ุชูุถุญ ูโุฏูู.

ุฏุฑ **ูุตู ฒฑ** ุฏูุจุงุฑู ุจู ููุถูุน **Multithreading** (ฺูุฏโุฑุดุชูโุง) ุจุง ุฌุฒุฆุงุช ุจุดุชุฑ ุจุฑูโฺฏุฑุฏู ู ุฏุฑ **ูุตู ฒฒ** ููุถูุน ูุฑุชุจุท ุนู **Parallel Programming** (ุจุฑูุงููโููุณ ููุงุฒ) ุฑุง ูพูุดุด ูโุฏูู.

---

## ๐น ููุฏูู

ุฏุฑ ุงุฏุงูู ุฑุงุฌโุชุฑู ุณูุงุฑููุง ููโุฒูุงู ุขูุฑุฏู ุดุฏู ุงุณุช:

### ๐ฅ๏ธ ููุดุชู ฺฉ ุฑุงุจุท ฺฉุงุฑุจุฑ ูพุงุณุฎโฺฏู

ุฏุฑ ุจุฑูุงููโูุง **WPF**ุ ููุจุงู ู **Windows Forms** ุจุงุฏ ฺฉุงุฑูุง ุฒูุงูโุจุฑ ุฑุง ุจูโุตูุฑุช ููโุฒูุงู ุจุง ฺฉุฏ ฺฉู ุฑุงุจุท ฺฉุงุฑุจุฑ ุดูุง ุฑุง ุงุฌุฑุง ูโฺฉูุฏ ุงูุฌุงู ุฏูุฏ ุชุง ุฑุงุจุท ฺฉุงุฑุจุฑ ููฺูุงู ูพุงุณุฎโฺฏู ุจุงู ุจูุงูุฏ.

### ๐ ูพุฑุฏุงุฒุด ููโุฒูุงู ุฏุฑุฎูุงุณุชโูุง

ุฑู ฺฉ ุณุฑูุฑุ ุฏุฑุฎูุงุณุชโูุง ฺฉูุงูุช ูโุชูุงููุฏ ุจูโุทูุฑ ููโุฒูุงู ุจุฑุณูุฏ ู ุจูุงุจุฑุงู ุจุงุฏ ุจูโุตูุฑุช ููุงุฒ ูพุฑุฏุงุฒุด ุดููุฏ ุชุง **Scalability** (ููุงุณโูพุฐุฑ) ุญูุธ ุดูุฏ. ุงฺฏุฑ ุงุฒ **ASP.NET Core** ุง **Web API** ุงุณุชูุงุฏู ฺฉูุฏุ ุฒูุงูโุงุฌุฑุง (Runtime) ุงู ฺฉุงุฑ ุฑุง ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุจุฑุง ุดูุง ุงูุฌุงู ูโุฏูุฏ.
ุจุงุงูโุญุงูุ ููฺูุงู ุจุงุฏ ูุณุจุช ุจู **Shared State** (ูุถุนุช ูุดุชุฑฺฉ) ุขฺฏุงู ุจุงุดุฏ (ุจุฑุง ูููููุ ุงุซุฑ ุงุณุชูุงุฏู ุงุฒ **Static Variables** ุจุฑุง ฺฉุดโฺฉุฑุฏู).

### โก ุจุฑูุงููโููุณ ููุงุฒ

ฺฉุฏ ฺฉู ูุญุงุณุจุงุช ุณูฺฏู ุงูุฌุงู ูโุฏูุฏ ูโุชูุงูุฏ ุฑู ุฑุงุงููโูุง ฺูุฏโูุณุชูโุง ุง ฺูุฏโูพุฑุฏุงุฒูุฏูโุง ุณุฑุนโุชุฑ ุงุฌุฑุง ุดูุฏุ ุงฺฏุฑ ุญุฌู ฺฉุงุฑ ูุงู ูุณุชูโูุง ุชูุณู ุดูุฏ. (ูุตู ฒฒ ุจูโุทูุฑ ฺฉุงูู ุจู ุงู ููุถูุน ุงุฎุชุตุงุต ุฏุงุฑุฏ.)

### ๐ฎ ุงุฌุฑุง ุญุฏุณ (Speculative Execution)

ุฑู ูุงุดูโูุง ฺูุฏโูุณุชูโุงุ ฺฏุงู ูโุชูุงู ุจุง ูพุดโุจู ฺฉุงุฑ ฺฉู ููฺฉู ุงุณุช ูุงุฒ ุจู ุงูุฌุงู ุขู ุจุงุดุฏ ู ุงูุฌุงู ุฏุงุฏู ุขู ุงุฒ ูุจูุ ุนููฺฉุฑุฏ ุฑุง ุจูุจูุฏ ุฏุงุฏ.
ุจุฑูุงูู **LINQPad** ุงุฒ ุงู ุชฺฉูฺฉ ุจุฑุง ุณุฑุนุชโุจุฎุดุฏู ุจู ุงุฌุงุฏ ฺฉูุฆุฑโูุง ุฌุฏุฏ ุงุณุชูุงุฏู ูโฺฉูุฏ.
ููุน ุฏฺฏุฑ ุงุฒ ุงู ุฑูุด ุงู ุงุณุช ฺฉู ฺูุฏ ุงูฺฏูุฑุชู ูุฎุชูู ุฑุง ุจูโุทูุฑ ููุงุฒ ุงุฌุฑุง ฺฉูุฏ ฺฉู ููฺฏ ฺฉ ูุธูู ูุดุงุจู ุฑุง ุญู ูโฺฉููุฏ. ูุฑฺฉุฏุงู ุฒูุฏุชุฑ ุชูุงู ุดูุฏ ยซุจุฑูุฏูยป ุฎูุงูุฏ ุจูุฏ. ุงู ุฑูุด ุฒูุงู ูุคุซุฑ ุงุณุช ฺฉู ุงุฒ ูุจู ูุฏุงูุฏ ฺฉุฏุงู ุงูฺฏูุฑุชู ุณุฑุนโุชุฑ ุนูู ุฎูุงูุฏ ฺฉุฑุฏ.

---

## ๐งต ูฺฉุงูุฒู ุนููู ููโุฒูุงู: Multithreading

ูฺฉุงูุฒู ุนูููโุง ฺฉู ุจู ฺฉ ุจุฑูุงูู ุงุฌุงุฒู ูโุฏูุฏ ุจูโุทูุฑ ููโุฒูุงู ฺฉุฏ ุฑุง ุงุฌุฑุง ฺฉูุฏุ **Multithreading** ูุงู ุฏุงุฑุฏ.
Multithreading ูู ุชูุณุท **CLR** ู ูู ุชูุณุท **ุณุณุชูโุนุงูู** ูพุดุชุจุงู ูโุดูุฏ ู ฺฉ ููููู ุจูุงุฏู ุฏุฑ ููโุฒูุงู ุงุณุช.
ุจูุงุจุฑุงู ุฏุฑฺฉ ูุจุงู **Threading**ุ ู ุจูโูฺู ุชุฃุซุฑ ุฑุดุชูโูุง ุจุฑ **Shared State** (ูุถุนุช ูุดุชุฑฺฉ)ุ ุถุฑูุฑ ุงุณุช.

---

## ๐งฉ Threading

ฺฉ **Thread** ุง ยซุฑุดุชูยปุ ฺฉ ูุณุฑ ุงุฌุฑุง ูุณุชูู ุงุณุช ฺฉู ูโุชูุงูุฏ ุฌุฏุง ุงุฒ ุณุงุฑ ูุณุฑูุง ูพุด ุจุฑูุฏ.

ูุฑ ุฑุดุชู ุฏุฑูู ฺฉ **Process** (ูุฑุงูุฏ) ุณุณุชูโุนุงูู ุงุฌุฑุง ูโุดูุฏ ฺฉู ูุญุท ุงุฒููู ุฑุง ุจุฑุง ุงุฌุฑุง ฺฉ ุจุฑูุงูู ูุฑุงูู ูโฺฉูุฏ.

* ุฏุฑ ฺฉ ุจุฑูุงูู **ุชฺฉโุฑุดุชูโุง** (Single-Threaded)ุ ุชููุง ฺฉ ุฑุดุชู ุฏุฑ ูุญุท ุงุฒููู ูพุฑุฏุงุฒุด ุงุฌุฑุง ูโุดูุฏ ู ุจูุงุจุฑุงู ุขู ุฑุดุชู ุฏุณุชุฑุณ ุงูุญุตุงุฑ ุจู ุขู ุฏุงุฑุฏ.
* ุฏุฑ ฺฉ ุจุฑูุงูู **ฺูุฏโุฑุดุชูโุง** (Multi-Threaded)ุ ฺูุฏ ุฑุดุชู ุฏุฑ ฺฉ ูุฑุงูุฏ ูุงุญุฏ ุงุฌุฑุง ูโุดููุฏ ู ฺฉ ูุญุท ุงุฌุฑุง ูุดุชุฑฺฉ (ุจูโูฺู ุญุงูุธู) ุฑุง ุจุง ูู ุจู ุงุดุชุฑุงฺฉ ูโฺฏุฐุงุฑูุฏ.

ุงู ููุถูุน ุฏูู ุงุตู ููุฏ ุจูุฏู Multithreading ุงุณุช:
ุจุฑุง ูููููุ ฺฉ ุฑุดุชู ูโุชูุงูุฏ ุฏุฑ ูพุณโุฒููู ุฏุงุฏูโูุง ุฑุง ูุงฺฉุด ฺฉูุฏุ ุฏุฑุญุงูโฺฉู ุฑุดุชู ุฏฺฏุฑ ููุงู ุฏุงุฏูโูุง ุฑุง ุจูโูุญุถ ุฑุณุฏู ููุงุด ุฏูุฏ. ุงู ุฏุงุฏูโูุง ุจูโุนููุงู **Shared State** ุดูุงุฎุชู ูโุดููุฏ.

---

## ๐๏ธ ุงุฌุงุฏ ฺฉ Thread

ฺฉ ุจุฑูุงูู ฺฉูุงูุช (**Console**ุ **WPF**ุ **UWP** ุง **Windows Forms**) ุฏุฑ ฺฉ ุฑุดุชู ูููุฑุฏ ฺฉู ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุชูุณุท ุณุณุชูโุนุงูู ุณุงุฎุชู ูโุดูุฏ (ุฑุดุชูโ ุงุตู ุง **Main Thread**) ุดุฑูุน ุจู ฺฉุงุฑ ูโฺฉูุฏ.
ุงู ุจุฑูุงูู ุชุง ุฒูุงู ฺฉู ุดูุง ฺฉุงุฑ ุฎูุงู ุขู ุงูุฌุงู ูุฏูุฏ (ุนู ุฑุดุชูโูุง ุจุดุชุฑ ุจุณุงุฒุฏุ ฺู ุจูโุทูุฑ ูุณุชูู ู ฺู ุบุฑูุณุชูู) ุจูโุตูุฑุช ุชฺฉโุฑุดุชูโุง ุจุงู ูโูุงูุฏ.ยน

ุจุฑุง ุงุฌุงุฏ ู ุดุฑูุน ฺฉ ุฑุดุชู ุฌุฏุฏุ ุจุงุฏ ฺฉ ุดุก ุงุฒ ููุน **Thread** ุจุณุงุฒุฏ ู ูุชุฏ **Start** ุขู ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ.
ุณุงุฏูโุชุฑู ุณุงุฒูุฏู (Constructor) ุจุฑุง Threadุ ฺฉ **ThreadStart Delegate** ูโฺฏุฑุฏ: ูุชุฏ ุจุฏูู ูพุงุฑุงูุชุฑ ฺฉู ูุดุงู ูโุฏูุฏ ุงุฌุฑุง ุฑุดุชู ุงุฒ ฺฉุฌุง ุขุบุงุฒ ุดูุฏ.

### ๐ ูุซุงู:

```csharp
// ุชูุฌู: ููู ูููููโูุง ุงู ูุตู ูุฑุถ ูโฺฉููุฏ ฺฉู Namespaceูุง ุฒุฑ Import ุดุฏูโุงูุฏ:
using System;
using System.Threading;

Thread t = new Thread (WriteY);     // ุงุฌุงุฏ ู ุฑุงูโุงูุฏุงุฒ ฺฉ ุฑุดุชู ุฌุฏุฏ
t.Start();                          // ุงุฌุฑุง ูุชุฏ WriteY ุฑู ุฑุดุชู ุฌุฏุฏ

// ููโุฒูุงูุ ุฑู ุฑุดุชู ุงุตู ูู ฺฉุงุฑ ุงูุฌุงู ูโุฏูู.
for (int i = 0; i < 1000; i++) Console.Write ("x");

void WriteY()
{
    for (int i = 0; i < 1000; i++) Console.Write ("y");
}
```

---

### ๐ค ุฎุฑูุฌ ููููู:

```
xxxxxxxxxxxxxxxxyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxyyyyyyyyyyyyyy
yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy
yyyyyyyyyyyyyyxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
...
```

---

ุฑุดุชู ุงุตู ฺฉ ุฑุดุชู ุฌุฏุฏ ุจู ูุงู `t` ูโุณุงุฒุฏ ู ุฑู ุขู ูุชุฏ ุฑุง ุงุฌุฑุง ูโฺฉูุฏ ฺฉู ฺฉุงุฑุงฺฉุชุฑ `y` ุฑุง ุจูโุทูุฑ ุชฺฉุฑุงุฑ ฺุงูพ ูโฺฉูุฏ.
ุจูโุทูุฑ ููโุฒูุงูุ ุฑุดุชู ุงุตู ูุฒ ฺฉุงุฑุงฺฉุชุฑ `x` ุฑุง ุจูโุทูุฑ ุชฺฉุฑุงุฑ ฺุงูพ ูโฺฉูุฏุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ุดฺฉู **ฑด-ฑ** ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช.

* ุฑู ฺฉ ุฑุงุงูู ุชฺฉโูุณุชูโุงุ ุณุณุชูโุนุงูู ุจุงุฏ ยซุจูุฑุดโูุงยป ุงุฒ ุฒูุงู (ูุนูููุงู ุญุฏูุฏ **ฒฐ ููโุซุงูู** ุฏุฑ ููุฏูุฒ) ุฑุง ุจู ูุฑ ุฑุดุชู ุงุฎุชุตุงุต ุฏูุฏ ุชุง ููโุฒูุงู ุดุจูโุณุงุฒ ุดูุฏ. ูุชุฌู ุงู ฺฉุงุฑุ ุจูุงฺฉโูุง ุชฺฉุฑุงุฑ ุงุฒ `x` ู `y` ุงุณุช.
* ุฑู ฺฉ ูุงุดู ฺูุฏโูุณุชูโุง ุง ฺูุฏโูพุฑุฏุงุฒูุฏูโุงุ ุฏู ุฑุดุชู ูโุชูุงููุฏ ูุงูุนุงู ุจูโุทูุฑ ููุงุฒ ุงุฌุฑุง ุดููุฏ (ุจุง ุงู ุดุฑุท ฺฉู ุฏฺฏุฑ ูพุฑุฏุงุฒูโูุง ูุนุงู ุฑู ุฑุงุงูู ูู ุฏุฑ ุฑูุงุจุช ุจุงุดูุฏ).
  ุจุงุงูโุญุงู ุฏุฑ ุงู ูุซุงู ููฺูุงู ุจูุงฺฉโูุง ุชฺฉุฑุงุฑ ุงุฒ `x` ู `y` ูุดุงูุฏู ูโฺฉูุฏุ ุฒุฑุง ุฌุฒุฆุงุช ุธุฑู ุฏุฑ ูฺฉุงูุฒู ูุฌูุฏ ุฏุงุฑุฏ ฺฉู **Console** ุฏุฑุฎูุงุณุชโูุง ููโุฒูุงู ุฑุง ูุฏุฑุช ูโฺฉูุฏ.

<div align="center">
    
![Conventions-UsedThis-Book](../../assets/image/14/Table-14-1.jpeg) 
</div>

## ๐ ูพุดโุงูุชุงุฒุฏู (Preemption)

ููุช ุงุฌุฑุง ฺฉ **Thread** ุจุง ุงุฌุฑุง ฺฉุฏ ุฑู ฺฉ **Thread** ุฏฺฏุฑ ุฏุฑ ูู ุขูุฎุชู ูโุดูุฏุ ฺฏูุชู ูโุดูุฏ ฺฉู ุขู Thread **Preempted** (ูพุดโุงูุชุงุฒ ุฏุงุฏู ุดุฏู) ุงุณุช. ุงู ุงุตุทูุงุญ ุงุบูุจ ุฒูุงู ุธุงูุฑ ูโุดูุฏ ฺฉู ุจุฎูุงูู ุชูุถุญ ุฏูู ฺุฑุง ฺุฒ ุจูโุฏุฑุณุช ฺฉุงุฑ ูฺฉุฑุฏู ุงุณุช!

---

## ๐ข ูุถุนุช ุฒูุฏู ุจูุฏู (IsAlive)

ูพุณ ุงุฒ ุดุฑูุน ุดุฏูุ ูฺฺฏ (**Property**) `IsAlive` ุฏุฑ ฺฉ Thread ููุฏุงุฑ **true** ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ุชุง ุฒูุงู ฺฉู ุขู Thread ูพุงุงู ุงุจุฏ.
ฺฉ Thread ุฒูุงู ูพุงุงู ูโุงุจุฏ ฺฉู **Delegate**ุง ฺฉู ุจู ุณุงุฒูุฏูโ (Constructor) ุขู ุฏุงุฏู ุดุฏูุ ุงุฌุฑุง ุฎูุฏ ุฑุง ุชูุงู ฺฉูุฏ. ูพุณ ุงุฒ ูพุงุงู ุงูุชูุ ฺฉ Thread ุฑุง ููโุชูุงู ุฏูุจุงุฑู ุฑุงูโุงูุฏุงุฒ ฺฉุฑุฏ.

---

## ๐ ูุงูโฺฏุฐุงุฑ Threadูุง

ูุฑ Thread ฺฉ ูฺฺฏ ุจู ูุงู **Name** ุฏุงุฑุฏ ฺฉู ูโุชูุงูุฏ ุขู ุฑุง ุจุฑุง ุงูุฏุงู **Debugging** ุชูุธู ฺฉูุฏ.
ุงู ูฺฺฏ ุฏุฑ **Visual Studio** ุจุณุงุฑ ููุฏ ุงุณุชุ ุฒุฑุง ูุงู Thread ุฏุฑ **Threads Window** ู ููุงุฑ ุงุจุฒุงุฑ **Debug Location** ููุงุด ุฏุงุฏู ูโุดูุฏ.
ุดูุง ุชููุง ฺฉโุจุงุฑ ูโุชูุงูุฏ ูุงู ฺฉ Thread ุฑุง ุชูุธู ฺฉูุฏุ ูุฑ ุชูุงุด ุฏฺฏุฑ ุจุฑุง ุชุบุฑ ูุงูุ ฺฉ **Exception** ุงุฌุงุฏ ุฎูุงูุฏ ฺฉุฑุฏ.

---

## ๐ ุฏุณุชุฑุณ ุจู Thread ูุนู

ูฺฺฏ ุงุณุชุงุชฺฉ `Thread.CurrentThread` ุฑุดุชูโุง ุฑุง ฺฉู ุฏุฑ ุญุงู ุญุงุถุฑ ุฏุฑ ุญุงู ุงุฌุฑุงุณุช ุจุฑูโฺฏุฑุฏุงูุฏ:

```csharp
Console.WriteLine (Thread.CurrentThread.Name);
```

---

## โณ Join ู Sleep

### ๐ Join

ูโุชูุงูุฏ ุจุง ูุฑุงุฎูุงู ูุชุฏ **Join** ููุชุธุฑ ุจูุงูุฏ ุชุง ฺฉ Thread ุฏฺฏุฑ ูพุงุงู ุงุจุฏ:

```csharp
Thread t = new Thread (Go);
t.Start();
t.Join();
Console.WriteLine ("Thread t has ended!");

void Go() 
{ 
    for (int i = 0; i < 1000; i++) Console.Write ("y"); 
}
```

ุงู ฺฉุฏ ุงุจุชุฏุง ฑฐฐฐ ุจุงุฑ `y` ฺุงูพ ูโฺฉูุฏ ู ุจูุงูุงุตูู ูพุณ ุงุฒ ุขู ูุชู `"Thread t has ended!"` ููุงุด ุฏุงุฏู ูโุดูุฏ.

ููฺูู ูโุชูุงูุฏ ููฺฏุงู ูุฑุงุฎูุงู **Join** ฺฉ **Timeout** ูุดุฎุต ฺฉูุฏ (ุจุฑุญุณุจ ููโุซุงูู ุง ฺฉ **TimeSpan**). ุฏุฑ ุงู ุตูุฑุช ูุชุฏ ููุฏุงุฑ **true** ุจุฑูโฺฏุฑุฏุงูุฏ ุงฺฏุฑ Thread ูพุงุงู ุงูุชู ุจุงุดุฏุ ุง **false** ุงฺฏุฑ ุฒูุงู ุชูุงู ุดุฏู ุจุงุดุฏ.

---

### ๐ Sleep

ูุชุฏ **Thread.Sleep** ุงุฌุฑุง Thread ูุนู ุฑุง ุจุฑุง ูุฏุช ูุดุฎุต ูุชููู ูโฺฉูุฏ:

```csharp
Thread.Sleep (TimeSpan.FromHours (1));  // ุชููู ุจุฑุง ฑ ุณุงุนุช
Thread.Sleep (500);                     // ุชููู ุจุฑุง ตฐฐ ููโุซุงูู
```

ูุฑุงุฎูุงู `Thread.Sleep(0)` ุจูุงูุงุตูู **ุจูุฑุด ุฒูุงู** (Time Slice) ูุนู ุฑุง ุขุฒุงุฏ ฺฉุฑุฏู ู ุฏุงูุทูุจุงูู CPU ุฑุง ุฏุฑ ุงุฎุชุงุฑ ุณุงุฑ Threadูุง ูุฑุงุฑ ูโุฏูุฏ.
ูุชุฏ `Thread.Yield()` ูุฒ ููู ฺฉุงุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏุ ุจุง ุงู ุชูุงูุช ฺฉู CPU ุฑุง ุชููุง ุจู Threadูุง ูุงฺฏุฐุงุฑ ูโฺฉูุฏ ฺฉู ุฑู ููุงู ูพุฑุฏุงุฒูุฏู ุฏุฑ ุญุงู ุงุฌุฑุง ูุณุชูุฏ.

* ุงุณุชูุงุฏู ุงุฒ `Sleep(0)` ุง `Yield` ฺฏุงู ุฏุฑ ฺฉุฏูุง **Production** ุจุฑุง ุจูููโุณุงุฒโูุง ูพุดุฑูุชูโ ุนููฺฉุฑุฏ ููุฏ ุงุณุช.
* ุงูโูุง ููฺูู ุงุจุฒุงุฑูุง ุนุงู **Diagnostic** (ุนุจโุงุจ) ูุณุชูุฏ: ุงฺฏุฑ ุงุถุงูู ฺฉุฑุฏู `Thread.Yield()` ุฏุฑ ูุฑุฌุง ฺฉุฏ ุดูุง ุจุงุนุซ ุฎุฑุงุจ ุดุฏู ุจุฑูุงูู ุดูุฏุ ุชูุฑุจุงู ูุทูุฆู ุจุงุดุฏ ฺฉู ฺฉ **Bug** ุฏุฑ ฺฉุฏุชุงู ูุฌูุฏ ุฏุงุฑุฏ.

---

## ๐ซ Block ุดุฏู ฺฉ Thread

ููุช ุงุฌุฑุง ฺฉ Thread ุจู ุฏูุงู ูุชููู ุดูุฏุ ฺฏูุชู ูโุดูุฏ ฺฉู ุขู Thread **Blocked** ุงุณุชุ ูุซูุงู ููฺฏุงู ุงุฌุฑุง **Sleep** ุง ููุชุธุฑ ูุงูุฏู ุจุฑุง ูพุงุงู ุงูุชู ฺฉ Thread ุฏฺฏุฑ ุจุง **Join**.

* ฺฉ Thread **Blocked** ุจูุงูุงุตูู ุจูุฑุด ุฒูุงู ูพุฑุฏุงุฒูุฏูโ ุฎูุฏ ุฑุง ุขุฒุงุฏ ูโฺฉูุฏ.
* ุงุฒ ุขู ูุญุธู ุจู ุจุนุฏุ ูฺ ุฒูุงู ุงุฒ CPU ูุตุฑู ููโฺฉูุฏ ุชุง ุฒูุงู ฺฉู ุดุฑุท Block ุดุฏู ุจุฑุทุฑู ุดูุฏ.

ุจุฑุง ุจุฑุฑุณ ุงูฺฉู ุขุง ฺฉ Thread ุฏุฑ ุญุงูุช Block ุงุณุช ูโุชูุงูุฏ ุงุฒ ูฺฺฏ **ThreadState** ุงุณุชูุงุฏู ฺฉูุฏ:

```csharp
bool blocked = (someThread.ThreadState & ThreadState.WaitSleepJoin) != 0;
```

---

## โ๏ธ ThreadState

ูฺฺฏ **ThreadState** ฺฉ **Flags Enum** ุงุณุช ฺฉู ุณู ยซูุงูยป ุฏุงุฏู ุฑุง ุจูโุตูุฑุช **Bitwise** ุชุฑฺฉุจ ูโฺฉูุฏ.
ุจุงุงูโุญุงู ุจุดุชุฑ ููุงุฏุฑ ุขู ุฒุงุฆุฏุ ุจูุงุงุณุชูุงุฏู ุง ููุณูุฎ ุดุฏูโุงูุฏ.

ุฑูุด ุชูุณุนูโุงูุชูโ ุฒุฑ ฺฉ ููุฏุงุฑ ThreadState ุฑุง ุจู ฺฉ ุงุฒ ฺูุงุฑ ููุฏุงุฑ ููุฏ ุณุงุฏูโุณุงุฒ ูโฺฉูุฏ:

* **Unstarted**
* **Running**
* **WaitSleepJoin**
* **Stopped**

```csharp
public static ThreadState Simplify (this ThreadState ts)
{
    return ts & (ThreadState.Unstarted |
                 ThreadState.WaitSleepJoin |
                 ThreadState.Stopped);
}
```

๐ ูฺฺฏ ThreadState ุจุฑุง ููุงุตุฏ **Diagnostic** ููุฏ ุงุณุชุ ุงูุง ุจุฑุง **Synchronization** ููุงุณุจ ูุณุชุ ุฒุฑุง ูุถุนุช ฺฉ Thread ูโุชูุงูุฏ ุจู ุจุฑุฑุณ ููุฏุงุฑ ThreadState ู ุนููโฺฉุฑุฏู ุจุฑ ุงุณุงุณ ุขู ุชุบุฑ ฺฉูุฏ.

ููฺฏุงูโฺฉู ฺฉ Thread **Block** ุง **Unblock** ูโุดูุฏุ ุณุณุชูโุนุงูู ฺฉ **Context Switch** ุงูุฌุงู ูโุฏูุฏ. ุงู ุนูู ูุฒููโ ุงูุฏฺฉ ุฏุงุฑุฏ (ูุนูููุงู ฺฉ ุง ุฏู ูฺฉุฑูุซุงูู).

---

## โ๏ธ I/O-bound ุฏุฑ ููุงุจู Compute-bound

* ุนููุงุช ฺฉู ุจุดุชุฑ ุฒูุงู ุฎูุฏ ุฑุง ุฏุฑ ุงูุชุธุงุฑ ุฑุฎโุฏุงุฏู ฺุฒ ูโฺฏุฐุฑุงูุฏุ **I/O-bound** ูุงูุฏู ูโุดูุฏ.
  ููููู: **ุฏุงูููุฏ ฺฉ ุตูุญู ูุจ** ุง ูุฑุงุฎูุงู `Console.ReadLine`.
  (ุนููุงุช I/O-bound ูุนูููุงู ุดุงูู ูุฑูุฏ ุง ุฎุฑูุฌ ูุณุชูุฏุ ุงูุง ุงู ฺฉ ุงูุฒุงู ูุทุน ูุณุช: `Thread.Sleep` ูู I/O-bound ูุญุณูุจ ูโุดูุฏ.)

* ุฏุฑ ููุงุจูุ ุนููุงุช ฺฉู ุจุดุชุฑ ุฒูุงู ุฎูุฏ ุฑุง ุตุฑู ุงูุฌุงู ฺฉุงุฑูุง ุณูฺฏู CPU ูโฺฉูุฏุ **Compute-bound** ูุงู ุฏุงุฑุฏ.

---

## ๐ Blocking ุฏุฑ ููุงุจู Spinning

ฺฉ ุนููุงุช I/O-bound ูโุชูุงูุฏ ุจู ุฏู ุตูุฑุช ุนูู ฺฉูุฏ:

1. **ุงูุชุธุงุฑ ููฺฏุงู (Synchronous)** ุฑู Thread ูุนู ุชุง ูพุงุงู ุนููุงุช (ูุซุงู: `Console.ReadLine`ุ `Thread.Sleep` ุง `Thread.Join`).
2. **ุนูู ูุงููฺฏุงู (Asynchronous)** ฺฉู ุจุง ูพุงุงู ุนููุงุช ุฏุฑ ุขูุฏูุ ฺฉ **Callback** ุงุฌุฑุง ูโฺฉูุฏ (ุจุดุชุฑ ุฏุฑ ุงุฏุงูู ุงู ูุตู ุชูุถุญ ุฏุงุฏู ูโุดูุฏ).

---

### ๐ Blocking ุจุง ุญููู Sleep

ุนููุงุชโูุง I/O-bound ฺฉู ุจูโุตูุฑุช ููฺฏุงู ููุชุธุฑ ูโูุงููุฏ ุจุดุชุฑ ุฒูุงู ุฎูุฏ ุฑุง ุฏุฑ ุญุงูุช Block ุณูพุฑ ูโฺฉููุฏ.
ฺฏุงู ุงู ุงูุชุธุงุฑ ุจู ุดฺฉู ฺฉ ุญูููโ Sleep ูพุงุฏูโุณุงุฒ ูโุดูุฏ:

```csharp
while (DateTime.Now < nextStartTime)
    Thread.Sleep (100);
```

---

### ๐ Spinning (ฺุฑุฎุด ูุฏุงูู)

ฺฏุฒููโ ุฏฺฏุฑ ุงู ุงุณุช ฺฉู ฺฉ Thread ุจูโุทูุฑ ูุฏุงูู ุจฺุฑุฎุฏ:

```csharp
while (DateTime.Now < nextStartTime);
```

ุงู ฺฉุงุฑ ุจูโุดุฏุช ููุช CPU ุฑุง ุชูู ูโฺฉูุฏ. ุงุฒ ุฏุฏ **CLR** ู ุณุณุชูโุนุงููุ Thread ุฏุฑ ุญุงู ุงูุฌุงู ฺฉ ูุญุงุณุจู ููู ุงุณุชุ ุจูุงุจุฑุงู ููุงุจุน ุจู ุขู ุงุฎุชุตุงุต ุฏุงุฏู ูโุดูุฏ. ุฏุฑ ุนููุ ูุง ฺฉ ุนููุงุช I/O-bound ุฑุง ุจู ฺฉ ุนููุงุช **Compute-bound** ุชุจุฏู ฺฉุฑุฏูโุงู.

---

## โจ ูฺฉุงุช ุธุฑู ุฏุฑุจุงุฑู Spinning ุฏุฑ ุจุฑุงุจุฑ Blocking

ฑ. **Spinning ฺฉูุชุงูโูุฏุช** ฺฏุงู ูโุชูุงูุฏ ูุคุซุฑ ุจุงุดุฏุ ุฒูุงู ฺฉู ุงูุชุธุงุฑ ุฏุงุฑุฏ ุดุฑุท ุจูโุฒูุฏ (ูุซูุงู ุฏุฑ ฺูุฏ ูฺฉุฑูุซุงูู) ุจุฑูุฑุงุฑ ุดูุฏ. ุงู ฺฉุงุฑ ุงุฒ ุณุฑุจุงุฑ ู ุชุฃุฎุฑ **Context Switch** ุฌููฺฏุฑ ูโฺฉูุฏ.
๐ ุจุฑุง ุงู ููุธูุฑุ .NET ูุชุฏูุง ู ฺฉูุงุณโูุง ุฎุงุต ูุซู **SpinLock** ู **SpinWait** ุฑุง ุงุฑุงุฆู ูโุฏูุฏ.

ฒ. **Blocking ูู ุจโูุฒูู ูุณุช**. ูุฑ Thread ุญุฏูุฏ **ฑ ูฺฏุงุจุงุช ุญุงูุธู** ุฑุง ุจุฑุง ุชูุงู ูุฏุช ุนูุฑุด ุงุดุบุงู ูโฺฉูุฏ ู ุจุฑุง **CLR** ู ุณุณุชูโุนุงูู ุจุงุฑ ูุฏุฑุช ูุฏุงูู ุงุฌุงุฏ ูโฺฉูุฏ.
ุจู ููู ุฏููุ Blocking ุฏุฑ ุจุฑูุงููโูุง ุจุณุงุฑ I/O-bound ฺฉู ุจุงุฏ ุตุฏูุง ุง ูุฒุงุฑุงู ุนููุงุช ููโุฒูุงู ุฑุง ูุฏุฑุช ฺฉููุฏ ูโุชูุงูุฏ ูุดฺฉูโุณุงุฒ ุดูุฏ.

๐ ุฏุฑ ฺูู ุดุฑุงุทุ ุจุฑูุงููโูุง ุจุงุฏ ุงุฒ ุฑูฺฉุฑุฏ **Callback-based** ุงุณุชูุงุฏู ฺฉููุฏุ ุนู ููฺฏุงู ุงูุชุธุงุฑุ Thread ุฎูุฏ ุฑุง ุจูโุทูุฑ ฺฉุงูู ุขุฒุงุฏ ฺฉููุฏ.
ุงู ุฏููุงู (ุจุฎุด ุงุฒ) ูุฏู ุงูฺฏููุง **Asynchronous** ุงุณุช ฺฉู ุฏุฑ ุงุฏุงูู ุจุฑุฑุณ ุฎูุงูู ฺฉุฑุฏ.
