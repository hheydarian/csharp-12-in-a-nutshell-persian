# ูุตู ุจุณุช ู ุฏูู:  ุจุฑูุงููโููุณ ููุงุฒ (Parallel Programming)

ุฏุฑ ุงู ูุตูุ ูุง ุจู **APIูุง** ู ุณุงุฎุชุงุฑูุง ฺูุฏูุฎ (multithreading) ูโูพุฑุฏุงุฒู ฺฉู ุจุง ูุฏู ุจูุฑูโุจุฑุฏุงุฑ ุงุฒ ูพุฑุฏุงุฒูุฏูโูุง ฺูุฏโูุณุชูโุง ุทุฑุงุญ ุดุฏูโุงูุฏ:

* **Parallel LINQ (PLINQ)**
* **ฺฉูุงุณ Parallel**
* **ุณุงุฎุชุงุฑูุง task parallelism**
* **ูุฌููุนูโูุง concurrent**

ุงู ุณุงุฎุชุงุฑูุง ุฏุฑ ูุฌููุน (ุจูโุตูุฑุช ุบุฑุฑุณู) ุจุง ุนููุงู **Parallel Framework (PFX)** ุดูุงุฎุชู ูโุดููุฏ.
ฺฉูุงุณ **Parallel** ููุฑุงู ุจุง ุณุงุฎุชุงุฑูุง **task parallelism** ุชุญุช ุนููุงู **Task Parallel Library (TPL)** ูุงูุฏู ูโุดููุฏ.

ูพุด ุงุฒ ูุทุงูุนูโ ุงู ูุตูุ ูุงุฒู ุงุณุช ุจุง ููุงูู ูพุงูโุง ุฏุฑ ูุตู ฑด ุขุดูุง ุจุงุดุฏโุจูโูฺู **locking**ุ **ุงูู ูุฎโูุง (thread safety)** ู ฺฉูุงุณ **Task**.

๐ง ุนูุงูู ุจุฑ ุงูโูุงุ .NET ูุฌููุนูโุง ุงุฒ APIูุง ุชุฎุตุต ุฏฺฏุฑ ุฑุง ุจุฑุง ฺฉูฺฉ ุจู ุจุฑูุงููโููุณ ููุงุฒ ู ูุงููฺฏุงู ุงุฑุงุฆู ูโุฏูุฏ:

* **System.Threading.Channels.Channel** โ ฺฉ ุตู ุชููุฏฺฉููุฏู/ูุตุฑูโฺฉููุฏู ูุงููฺฏุงู ุจุง ฺฉุงุฑุง ุจุงูุงุ ฺฉู ุฏุฑ **.NET Core 3** ูุนุฑู ุดุฏ.
* **Microsoft Dataflow** (ุฏุฑ ูุถุง ูุงู System.Threading.Tasks.Dataflow) โ ฺฉ API ูพุดุฑูุชู ุจุฑุง ุงุฌุงุฏ ุดุจฺฉูโุง ุงุฒ ุจููฺฉโูุง ุจุงูุฑ ุดุฏู (buffered blocks) ฺฉู ุนููุงุช ุง ุชุจุฏู ุฏุงุฏูโูุง ุฑุง ุจูโุตูุฑุช ููุงุฒ ุงุฌุฑุง ูโฺฉููุฏ ู ุดุจุงูุช ุฒุงุฏ ุจู ุจุฑูุงููโููุณ actor/agent ุฏุงุฑูุฏ.
* **Reactive Extensions** โ ูพุงุฏูโุณุงุฒ LINQ ุฑู **IObservable** (ุฌุงฺฏุฒู ุจุฑุง **IAsyncEnumerable**) ฺฉู ุฏุฑ ุชุฑฺฉุจ ุฌุฑุงูโูุง ูุงููฺฏุงู ุจุณุงุฑ ูุฏุฑุชููุฏ ุงุณุช. ุงู ูุงุจูุช ุงุฒ ุทุฑู ุจุณุชูโ **System.Reactive NuGet** ุนุฑุถู ูโุดูุฏ.

---

## ฺุฑุง PFXุ ๐ค

ุฏุฑ ฑต ุณุงู ฺฏุฐุดุชูุ ุณุงุฒูุฏฺฏุงู CPU ุงุฒ ูพุฑุฏุงุฒูุฏูโูุง ุชฺฉโูุณุชูโุง ุจู ฺูุฏโูุณุชูโุง ููุงุฌุฑุช ฺฉุฑุฏูโุงูุฏ. ุงู ููุถูุน ุจุฑุง ูุง ุจุฑูุงููโููุณุงู ูุดฺฉูโุณุงุฒ ุงุณุชุ ุฒุฑุง ฺฉุฏูุง ุชฺฉโูุฎ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุงุฒ ูุณุชูโูุง ุจุดุชุฑ ุณุฑุนโุชุฑ ุงุฌุฑุง ููโุดููุฏ.

ุงุณุชูุงุฏู ุงุฒ ฺูุฏโูุณุชู ุฏุฑ ุจุณุงุฑ ุงุฒ ุจุฑูุงููโูุง ุณูุช ุณุฑูุฑ ุณุงุฏู ุงุณุชุ ฺูู ูุฑ ูุฎ ูโุชูุงูุฏ ฺฉ ุฏุฑุฎูุงุณุช ูุดุชุฑ ุฌุฏุงฺฏุงูู ุฑุง ุจูโุทูุฑ ูุณุชูู ูพุฑุฏุงุฒุด ฺฉูุฏ. ุงูุง ุฑู ุฏุณฺฉุชุงูพ ุงู ููุถูุน ุฏุดูุงุฑุชุฑ ุงุณุชุ ฺูู ูุนูููุงู ูุงุฒ ุฏุงุฑุฏ ฺฉุฏ ุฑุง ฺฉู ูุญุงุณุจุงุช ุณูฺฏู ุฏุงุฑุฏ ุจู ุงู ุตูุฑุช ุชุบุฑ ุฏูุฏ:

1. ุชูุณู ุขู ุจู ูุทุนูโูุง ฺฉูฺฺฉโุชุฑ.
2. ุงุฌุฑุง ุงู ูุทุนูโูุง ุจูโุตูุฑุช ููุงุฒ ุจุง ฺูุฏูุฎ.
3. ุฌูุนโุขูุฑ ูุชุงุฌ ุฏุฑ ุฒูุงู ฺฉู ุขูุงุฏู ูโุดููุฏุ ุจู ุดฺฉู **ุงูู ุงุฒ ูุธุฑ ูุฎโูุง** ู ฺฉุงุฑุง.

ุงูุจุชู ุงูุฌุงู ูููโ ุงู ูุฑุงุญู ุจุง ุณุงุฎุชุงุฑูุง ฺฉูุงุณฺฉ ฺูุฏูุฎ ููฺฉู ุงุณุชุ ุงูุง ุฏุณุชโููพุงฺฏุฑ ุงุณุชโุจูโุฎุตูุต ูุฑุงุญู ุชูุณูโุจูุฏ ู ุฌูุนโุขูุฑ ูุชุงุฌ. ูุดฺฉู ุฏฺฏุฑ ุงู ุงุณุช ฺฉู ุงุณุชุฑุงุชฺ ุฑุงุฌ **locking ุจุฑุง ุงูู ูุฎโูุง**ุ ููฺฏุงู ฺฉุงุฑ ููโุฒูุงู ฺูุฏ ูุฎ ุฑู ุฏุงุฏูโูุง ูุดุชุฑฺฉุ ุจุงุนุซ ุงุฌุงุฏ ุฑูุงุจุช (contention) ุฒุงุฏ ูโุดูุฏ.

ฺฉุชุงุจุฎุงููโูุง **PFX** ุฏููุงู ุจุฑุง ุญู ุงู ุณูุงุฑููุง ุทุฑุงุญ ุดุฏูโุงูุฏ.

---

## ููุงูู PFX ๐งฉ

ุจุฑูุงููโููุณ ุจุฑุง ุจูุฑูโุจุฑุฏุงุฑ ุงุฒ ฺูุฏโูุณุชู ุง ฺูุฏ ูพุฑุฏุงุฒูุฏูุ **parallel programming** ูุงู ุฏุงุฑุฏ. ุงู ููุถูุน ฺฉ ุฒุฑูุฌููุนู ุงุฒ ููููู ฺฏุณุชุฑุฏูโุชุฑ **multithreading** ุงุณุช.

ุฏู ุงุณุชุฑุงุชฺ ุงุตู ุจุฑุง ุชูุณู ฺฉุงุฑ ุจู ูุฎโูุง ูุฌูุฏ ุฏุงุฑุฏ:

* **Data Parallelism (ููุงุฒโุณุงุฒ ุฏุงุฏูโูุง)**
* **Task Parallelism (ููุงุฒโุณุงุฒ ูุธุงู)**

๐น ุฏุฑ **data parallelism**ุ ููุช ูุฌููุนูโุง ุงุฒ ูุธุงู ุจุงุฏ ุฑู ุฏุงุฏูโูุง ุฒุงุฏ ุงุฌุฑุง ุดููุฏุ ูุฑ ูุฎ ููุงู ูุฌููุนู ูุธุงู ุฑุง ุฑู ุจุฎุด ุงุฒ ุฏุงุฏูโูุง ุงุฌุฑุง ูโฺฉูุฏ. ุฏุฑ ูุงูุน ุฏุงุฏูโูุง ุจู ูุฎโูุง ุชูุณู ูโุดููุฏ.

๐น ุฏุฑ **task parallelism**ุ ูุง ูุธุงู ุฑุง ุชูุณู ูโฺฉููุ ุจู ุงู ูุนูุง ฺฉู ูุฑ ูุฎ ูุธููโุง ูุชูุงูุช ุฑุง ุงุฌุฑุง ูโฺฉูุฏ.

ุจูโุทูุฑ ฺฉูุ **data parallelism** ุณุงุฏูโุชุฑ ุงุณุช ู ุฑู ุณุฎุชโุงูุฒุงุฑูุง ุจุง ูุงุจูุช ููุงุฒโุณุงุฒ ุจุงูุง ุจูุชุฑ ููุงุณโูพุฐุฑ ุงุณุชุ ุฒุฑุง ุฏุงุฏูโูุง ูุดุชุฑฺฉ ุฑุง ฺฉุงูุด ูโุฏูุฏ ุง ุญุฐู ูโฺฉูุฏ (ุฏุฑ ูุชุฌู ูุดฺฉูุงุช ุฑูุงุจุช ู ุงูู ูุฎโูุง ูุฒ ฺฉูุชุฑ ูโุดูุฏ). ุนูุงููโุจุฑ ุงูุ ูุนูููุงู ุฏุงุฏูโูุง ุจุด ุงุฒ ูุธุงู ุฌุฏุงฺฏุงูู ูุณุชูุฏุ ู ุงู ุงูุฑ ูพุชุงูุณู ููุงุฒโุณุงุฒ ุฑุง ุงูุฒุงุด ูโุฏูุฏ.

**Data parallelism** ููฺูู ุฒูููโุณุงุฒ **structured parallelism** ุงุณุชุ ุจู ุงู ูุนูุง ฺฉู ฺฉุงุฑูุง ููุงุฒ ุฏุฑ ฺฉ ููุทู ุงุฒ ุจุฑูุงูู ุดุฑูุน ู ุฏุฑ ููุงูโุฌุง ูุฒ ูพุงุงู ูโุงุจูุฏ. ุฏุฑ ููุงุจูุ **task parallelism** ูุนูููุงู **unstructured** ุงุณุชุ ุนู ฺฉุงุฑูุง ููุงุฒ ููฺฉู ุงุณุช ุฏุฑ ุจุฎุดโูุง ูพุฑุงฺฉูุฏูโุง ุงุฒ ุจุฑูุงูู ุดุฑูุน ู ูพุงุงู ุงุจูุฏ.

๐ **Structured parallelism** ุณุงุฏูโุชุฑุ ฺฉูโุฎุทุงุชุฑุ ู ุงูฺฉุงู ูุงฺฏุฐุงุฑ ฺฉุงุฑูุง ุฏุดูุงุฑ ูุงููุฏ ุชูุณูโุจูุฏุ ููุงููฺฏ ูุฎโูุง ู ุญุช ุฌูุนโุขูุฑ ูุชุงุฌ ุฑุง ุจู ฺฉุชุงุจุฎุงููโูุง ูุฑุงูู ูโฺฉูุฏ.

---

## ุงุฌุฒุง PFX ๐๏ธ

ฺฉุชุงุจุฎุงููโ **PFX** ุงุฒ ุฏู ูุงูโ ุงุตู ุชุดฺฉู ุดุฏู ุงุณุช (ูุทุงุจู ุดฺฉู 22-1):

* **ูุงู ุจุงูุงุชุฑ** โ ุดุงูู ุฏู API ุจุฑุง data parallelism ุณุงุฎุชุงุฑุงูุชู:

  * **PLINQ**
  * **ฺฉูุงุณ Parallel**

* **ูุงู ูพุงูโุชุฑ** โ ุดุงูู ฺฉูุงุณโูุง task parallelism ุจูโุนูุงูู ูุฌููุนูโุง ุงุฒ ุณุงุฎุชุงุฑูุง ฺฉูฺฉ ุจุฑุง ูุนุงูุชโูุง ุจุฑูุงููโููุณ ููุงุฒ.

 <div align="center">
    
![Conventions-UsedThis-Book](../../assets/image/22/Table-22-1.jpeg) 
</div>


