# ูุตู ูุฌุฏูู:  ุจุงุฒุชุงุจ (Reflection) ู ูุชุงุฏุชุง

ููุงูโุทูุฑ ฺฉู ุฏุฑ ูุตู ฑท ุฏุฏูุ ฺฉ ุจุฑูุงููโ C# ุจู ฺฉ **Assembly** ฺฉุงููพุงู ูโุดูุฏ ฺฉู ุดุงูู **ูุชุงุฏุชุง (Metadata)**ุ ฺฉุฏ ฺฉุงููพุงูโุดุฏู ู ููุงุจุน (Resources) ุงุณุช. ุจุฑุฑุณ ูุชุงุฏุชุง ู ฺฉุฏ ฺฉุงููพุงูโุดุฏู ุฏุฑ ุฒูุงู ุงุฌุฑุง ุฑุง **Reflection (ุจุงุฒุชุงุจ)** ูโูุงููุฏ.

ฺฉุฏ ฺฉุงููพุงูโุดุฏู ุฏุฑ ฺฉ Assembly ุชูุฑุจุงู ุชูุงู ูุญุชูุง ฺฉุฏ ููุจุน ุงุตู ุฑุง ุฏุฑ ุจุฑ ุฏุงุฑุฏ. ุจุง ุงู ุญุงูุ ุจุฑุฎ ุงุทูุงุนุงุช ูุงููุฏ ูุงู ูุชุบุฑูุง ูุญูุ ุชูุถุญุงุช (Comments) ู ุฏุณุชูุฑูุง ูพุดโูพุฑุฏุงุฒูุฏู (Preprocessor Directives) ุงุฒ ุฏุณุช ูโุฑููุฏ. ุงูุง ุจุงุฒุชุงุจ ุจู ูุง ุงูฺฉุงู ุฏุณุชุฑุณ ุจู ุชูุฑุจุงู ุชูุงู ููุงุฑุฏ ุฏฺฏุฑ ุฑุง ูโุฏูุฏโุญุช ุชุง ุญุฏ ฺฉู ูโุชูุงู ฺฉ **Decompiler** (ุฏโฺฉุงููพุงูุฑ) ููุดุช. ๐

ุจุณุงุฑ ุงุฒ ุณุฑูุณโูุง ููุฌูุฏ ุฏุฑ .NET ู ุฏุฑ ุฏุณุชุฑุณ ุงุฒ ุทุฑู C# (ูุงููุฏ **Dynamic Binding**ุ **Serialization** ู **Data Binding**) ุจู ูุฌูุฏ ูุชุงุฏุชุง ูุงุจุณุชู ูุณุชูุฏ. ููฺูู ุจุฑูุงููโูุง ุดูุง ูุฒ ูโุชูุงููุฏ ุงุฒ ุงู ูุชุงุฏุชุง ุงุณุชูุงุฏู ฺฉููุฏ ู ุญุช ุขู ุฑุง ุจุง ุงุทูุงุนุงุช ุฌุฏุฏ ุงุฒ ุทุฑู **Custom Attributes** ฺฏุณุชุฑุด ุฏููุฏ. ูุถุง ูุงู `System.Reflection` ุดุงูู API ูุฑุจูุท ุจู Reflection ุงุณุช. ุนูุงูู ุจุฑ ุงูุ ุฏุฑ ุฒูุงู ุงุฌุฑุง ูโุชูุงู ูุชุงุฏุชุง ู ุฏุณุชูุฑุงูุนููโูุง ุงุฌุฑุง ุฌุฏุฏ ุฏุฑ ุณุทุญ **Intermediate Language (IL)** ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณโูุง ููุฌูุฏ ุฏุฑ ูุถุง ูุงู `System.Reflection.Emit` ุงุฌุงุฏ ฺฉุฑุฏ.

ูููููโูุง ุงู ูุตู ูุฑุถ ูโฺฉููุฏ ฺฉู ุดูุง ูุถุง ูุงูโูุง `System` ู `System.Reflection` ู ููฺูู `System.Reflection.Emit` ุฑุง ูุงุฑุฏ ฺฉุฑุฏูโุงุฏ.

ููุช ุฏุฑ ุงู ูุตู ุงุฒ ุงุตุทูุงุญ **ยซุจูโุตูุฑุช ุฏูุงูฺฉยป (Dynamically)** ุงุณุชูุงุฏู ูโฺฉููุ ููุธูุฑ ุงู ุงุณุช ฺฉู ุนูู ุฑุง ุจุง Reflection ุงูุฌุงู ุฏูู ฺฉู **ุงูู ููุน (Type Safety)** ุขู ููุท ุฏุฑ ุฒูุงู ุงุฌุฑุง ฺฉูุชุฑู ูโุดูุฏ. ุงู ููุถูุน ุงุฒ ูุธุฑ ุงุตูู ูุดุงุจู **Dynamic Binding** ุฏุฑ C# ุจุง ฺฉูุฏูุงฺูโ `dynamic` ุงุณุชุ ุงูุง ูฺฉุงูุฒู ู ุนููฺฉุฑุฏ ุขู ูุชูุงูุช ุงุณุช.

* **Dynamic Binding** ุงุณุชูุงุฏูโ ุขุณุงูโุชุฑ ุฏุงุฑุฏ ู ุงุฒ **Dynamic Language Runtime (DLR)** ุจุฑุง ุณุงุฒฺฏุงุฑ ุจุง ุฒุจุงูโูุง ูพูุง ุงุณุชูุงุฏู ูโฺฉูุฏ.
* **Reflection** ูุณุจุช ุจู ุขู ฺฉู ุฏุณุชโููพุงฺฏุฑุชุฑ ุงุณุชุ ุงูุง ุงูุนุทุงู ุจุดุชุฑ ุฏุฑ ุงุฑุชุจุงุท ุจุง **CLR** ุงุฑุงุฆู ูโุฏูุฏ.

ุจุฑุง ูุซุงูุ Reflection ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ:
โ๏ธ ููุฑุณุช ุงุฒ **Types** ู **Members** ุฏุฑุงูุช ฺฉูุฏ.
โ๏ธ ฺฉ ุดุก ุฑุง ุจุง ูุงู ฺฉู ุงุฒ ฺฉ ุฑุดุชู (String) ูโุขุฏ ุจุณุงุฒุฏ.
โ๏ธ ุฏุฑ ูุญุธู (On the fly) Assembly ุชููุฏ ฺฉูุฏ.

---

## ๐ Reflecting and Activating Types

ุฏุฑ ุงู ุจุฎุด ุจุฑุฑุณ ูโฺฉูู ฺฉู ฺฺฏููู ูโุชูุงู ฺฉ **Type** ุฑุง ุจู ุฏุณุช ุขูุฑุฏุ ูุชุงุฏุชุง ุขู ุฑุง ุจุฑุฑุณ ฺฉุฑุฏ ู ุงุฒ ุขู ุจุฑุง ุงุฌุงุฏ ุฏูุงูฺฉ ฺฉ ุดุก ุงุณุชูุงุฏู ูููุฏ.

### ๐ Obtaining a Type

ฺฉ ููููู ุงุฒ `System.Type` ููุงุงูฺฏุฑ ูุชุงุฏุชุง ฺฉ Type ุงุณุช. ุงุฒ ุขูโุฌุง ฺฉู **Type** ุจุณุงุฑ ูพุฑฺฉุงุฑุจุฑุฏ ุงุณุชุ ุฏุฑ ูุถุง ูุงู `System` ูุฑุงุฑ ุฏุงุฑุฏุ ูู ุฏุฑ `System.Reflection`.

ุฑูุดโูุง ุจูโุฏุณุชโุขูุฑุฏู ฺฉ ูููููโ `System.Type`:

ฑ. ูุฑุงุฎูุงู ูุชุฏ `GetType` ุฑู ูุฑ ุดุก:

```csharp
Type t1 = DateTime.Now.GetType();     // Type ุจุฏุณุชโุขูุฏู ุฏุฑ ุฒูุงู ุงุฌุฑุง
```

ฒ. ุงุณุชูุงุฏู ุงุฒ ุนููฺฏุฑ `typeof` ุฏุฑ C#:

```csharp
Type t2 = typeof(DateTime);          // Type ุจุฏุณุชโุขูุฏู ุฏุฑ ุฒูุงู ฺฉุงููพุงู
```

ุจุง ุงุณุชูุงุฏู ุงุฒ `typeof` ูโุชูุงูุฏ Type ุขุฑุงูโูุง ู Typeูุง ุฌูุฑฺฉ ุฑุง ูุฒ ุจฺฏุฑุฏ:

```csharp
Type t3 = typeof(DateTime[]);          // ุขุฑุงู ฺฉโุจุนุฏ
Type t4 = typeof(DateTime[,]);         // ุขุฑุงู ุฏูุจุนุฏ
Type t5 = typeof(Dictionary<int,int>); // ุฌูุฑฺฉ ุจุณุชู (Closed Generic Type)
Type t6 = typeof(Dictionary<,>);       // ุฌูุฑฺฉ ุจุงุฒ (Unbound Generic Type)
```

ณ. ุฏุฑุงูุช Type ุงุฒ ุทุฑู ูุงู (Name):
ุงฺฏุฑ ฺฉ ูุฑุฌุน ุจู Assembly ุฏุงุดุชู ุจุงุดุฏ:

```csharp
Type t = Assembly.GetExecutingAssembly().GetType("Demos.TestProgram");
```

ุงฺฏุฑ Assembly ุฑุง ูุฏุงุดุชู ุจุงุดุฏุ ูโุชูุงูุฏ ุงุฒ **Assembly Qualified Name** ุงุณุชูุงุฏู ฺฉูุฏ (ูุงู ฺฉุงูู Type ุจูโููุฑุงู ูุงู ฺฉุงูู ุง ุฌุฒุฆ Assembly). ุฏุฑ ุงู ุญุงูุช Assembly ุจูโุทูุฑ ุถูู ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ:

```csharp
Type t = Type.GetType("System.Int32, System.Private.CoreLib");
```

ูพุณ ุงุฒ ุฏุฑ ุงุฎุชุงุฑ ุฏุงุดุชู ฺฉ ุดุก `System.Type`ุ ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ูฺฺฏโูุง ุขู ุจู ุงุทูุงุนุงุช ูุงููุฏ ูุงูุ Assemblyุ Base Typeุ ุณุทุญ ุฏุณุชุฑุณ (Visibility) ู ... ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ:

```csharp
Type stringType = typeof(string);
string name     = stringType.Name;          // String
Type baseType   = stringType.BaseType;      // typeof(Object)
Assembly assem  = stringType.Assembly;      // System.Private.CoreLib
bool isPublic   = stringType.IsPublic;      // true
```

ฺฉ ุดุก ุงุฒ ููุน `System.Type` ุฏุฑ ูุงูุน ูพูุฌุฑูโุง ุจู ุชูุงู ูุชุงุฏุชุง ูุฑุจูุท ุจู ุขู Type ู Assembly ุญุงู ุขู ุงุณุช.

> `System.Type` ฺฉ ฺฉูุงุณ **Abstract** ุงุณุชุ ุจูุงุจุฑุงู ุนููฺฏุฑ `typeof` ุฏุฑ ูุงูุน ฺฉ ุฒุฑฺฉูุงุณ ุงุฒ Type ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ. ุฒุฑฺฉูุงุณ ฺฉู CLR ุงุณุชูุงุฏู ูโฺฉูุฏ ุฏุงุฎู (Internal) ุจูุฏู ู ูุงู ุขู **RuntimeType** ุงุณุช.

---

## ๐ TypeInfo

ุงฺฏุฑ ุดูุง ูุฏูโฺฏุฐุงุฑ ุฑู **.NET Core 1.x** (ุง ูพุฑููุงูโูุง ูุฏูโุชุฑ Windows Store) ุฏุงุดุชู ุจุงุดุฏุ ุจุณุงุฑ ุงุฒ ุงุนุถุง `Type` ุฏุฑ ุฏุณุชุฑุณ ูุณุชูุฏ. ุงู ุงุนุถุง ุจู ุฌุง ุขู ุฏุฑ ฺฉูุงุณ ุจู ูุงู `TypeInfo` ุงุฑุงุฆู ูโุดููุฏ ฺฉู ุงุฒ ุทุฑู ูุฑุงุฎูุงู `GetTypeInfo` ุจูโุฏุณุช ูโุขุฏ.

ุจุฑุง ุงุฌุฑุง ูุซุงู ูุจู ุฏุฑ ฺูู ูุญุทุ ฺฉุฏ ุดูุง ุงูโฺฏููู ุฎูุงูุฏ ุจูุฏ:

```csharp
Type stringType = typeof(string);
string name = stringType.Name;
Type baseType = stringType.GetTypeInfo().BaseType;
Assembly assem = stringType.GetTypeInfo().Assembly;
bool isPublic = stringType.GetTypeInfo().IsPublic;
```

ฺฉูุงุณ `TypeInfo` ุฏุฑ **.NET Core 2 ู 3** ู **.NET 5+** (ู ููฺูู ุฏุฑ **.NET Framework 4.5+** ู ุชูุงู ูุณุฎูโูุง **.NET Standard**) ูุฒ ูุฌูุฏ ุฏุงุฑุฏ. ุจูุงุจุฑุงู ฺฉุฏ ุจุงูุง ุชูุฑุจุงู ุจูโุทูุฑ ุฌูุงู (Universal) ูุงุจู ุงุฌุฑุงุณุช.

ููฺูู `TypeInfo` ูฺฺฏโูุง ู ูุชุฏูุง ุงุถุงู ุจุฑุง ุจุงุฒุชุงุจ ุฑู ุงุนุถุง (Reflecting over Members) ุฏุฑ ุงุฎุชุงุฑ ูุฑุงุฑ ูโุฏูุฏ.


